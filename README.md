# 6-12 Nutritional Calculator


## Getting Started

Docker (and docker composer) is required to run the service with its database dependency.

__Note__: see [Environment Variables section](#environment-variables) on what to provide for database credentials when running via docker compose.

You can bring up the webserver and MySQL database containers by:
```
docker compose up -d
```

The webserver container is configured to wait until the database container is running and healthy until it starts up.

The service is accessible on localhost over port 8080 once the container has booted up.

## Migrations

We use Phinx for handling database migrations.  
You can create a new migration script from the command line by:
```
composer migration:gen <migration_script_name>
```

This creates a new migration script in the `db/migrations/` directory.


Pending migrations can be run by:
```
composer migrate
```

Similarly, seed data scripts can be generated by running 
```
composer seed:create
```

and they can be run by:
```
composer seed:run
``` 


## Environment Variables

The following environment variables are required to establish a database connection:
- DB_HOST  - set to the host where the database is running. On Docker Composer, this is the name of the database container i.e `6-12-nutritional-db`
- DB_NAME - the name of the MySQL database, defaults to `6_12_nutritional_info` as mentioned in the docker-compose.yml file
- DB_USER - service user for the webapp to interact with MySQL, defaults to `6_12_nutritional_service`
- DB_PORT - MySQL port, default 3306
- DB_PASSWORD_FILE - file containing the database password for `DB_USER`, on Docker Compose this is a file name `db_password.txt` that is added as a Docker secret.